<table>
  <caption><%= translate(".table.caption") %></caption>
  <thead>
    <tr>
      <th><%= Book.human_attribute_name(:title) %></th>
      <th><%= LineItem.human_attribute_name(:quantity) %></th>
      <th><%= Book.human_attribute_name(:price) %></th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% order.line_items.includes(:book).each do |line_item| %>
      <tr>
        <td><%= line_item.title %></td>
        <td>
          <%= form_with(model: line_item, html: {
              "data-scroll-permanent": true,
              "data-controller": "form",
              "data-action": "change->form#requestSubmit",
            },
          ) do |form| %>
          <fieldset data-controller="number-field">
              <button type="button" data-action="click->number-field#stepDown">-</button>

              <%= form.label :quantity, translate(".table.line_item.quantity", count: line_item.quantity) %>
              <%= form.number_field :quantity, min: 1, "data-number-field-target": "input" %>

              <button type="button" data-action="click->number-field#stepUp">+</button>
            </fieldset>

            <noscript>
              <%= form.submit(class: "button") %>
            </noscript>
          <% end %>
        </td>
        <td><%= number_to_currency(line_item.price) %></td>
        <td>
          <%= form_with(model: line_item, method: :delete, html: { "data-scroll-permanent": true }) do |form| %>
            <%= form.submit(class: "button button--destructive") %>
          <% end %>
        </td>
      </tr>
    <% end %>

    <tr>
      <td></td>
      <td></td>
      <td><%= translate(".table.total", total: number_to_currency(order.total)) %></td>
      <td></td>
    </tr>
  </tbody>
</table>
